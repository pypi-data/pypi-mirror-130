(this.webpackJsonpsqllineagejs=this.webpackJsonpsqllineagejs||[]).push([[0],{463:function(e,t,n){},741:function(e,t,n){"use strict";n.r(t);var r,a=n(7),i=n.n(a),o=n(89),c=n.n(o),s=(n(463),n(36)),l=n(22),d=n(806),u=n(763),j=n(807),b=n(761),f=n(804),g=n(810),h=n(811),p=n(805),m=n(808),O=n(426),x=n.n(O),v=n(427),y=n.n(v),w=n(356),S=n.n(w),C=n(128),L=n(12),E=n.n(L),_=n(232),k=n(210),N=n(213),z=n(447);function T(e){var t=new URL(window.location.href),n=Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).REACT_APP_BACKEND_PORT,r=n?t.origin.replace(t.port,n):t.origin;return"".concat(r).concat(e)}function I(e){return D.apply(this,arguments)}function D(){return(D=Object(_.a)(E.a.mark((function e(t){var n,r,a,i,o,c,s,l=arguments;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=l.length>1&&void 0!==l[1]?l[1]:{},r=n.body,a=Object(z.a)(n,["body"]),i={"Content-Type":"application/json"},o=Object(N.a)(Object(N.a)({method:r?"POST":"GET"},a),{},{headers:Object(N.a)(Object(N.a)({},i),a.headers)}),r&&(o.body=JSON.stringify(r)),e.next=6,window.fetch(t,o);case 6:return s=e.sent,e.next=9,s.json();case 9:if(c=e.sent,!s.ok){e.next=14;break}return e.abrupt("return",c);case 14:return e.abrupt("return",Promise.reject(c||s.statusText));case 15:case"end":return e.stop()}}),e)})))).apply(this,arguments)}I.get=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return I(e,Object(N.a)(Object(N.a)({},t),{},{method:"GET"}))},I.post=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return I(e,Object(N.a)(Object(N.a)({},n),{},{body:t}))};var P=Object(k.b)("editor/fetchContent",function(){var e=Object(_.a)(E.a.mark((function e(t){return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,I.post(T("/script"),t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),Q=Object(k.b)("dag/fetchDAG",function(){var e=Object(_.a)(E.a.mark((function e(t){return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,I.post(T("/lineage"),t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),H=Object(k.c)({name:"editor",initialState:{file:"",content:"",contentComposed:"",editable:!1,editorStatus:"idle",editorError:null,dagContent:[],dagColumn:[],dagLevel:"table",dagVerbose:"",dagStatus:"idle",dagError:null},reducers:{setContentComposed:function(e,t){e.contentComposed=t.payload},setEditable:function(e,t){e.editable=t.payload},setFile:function(e,t){e.file=t.payload},setDagLevel:function(e,t){e.dagLevel=t.payload}},extraReducers:(r={},Object(s.a)(r,P.pending,(function(e){e.editorStatus="loading"})),Object(s.a)(r,P.fulfilled,(function(e,t){e.editorStatus="succeeded",e.content=t.payload.content})),Object(s.a)(r,P.rejected,(function(e,t){e.editorStatus="failed",e.editorError=t.error.message})),Object(s.a)(r,Q.pending,(function(e){e.dagStatus="loading"})),Object(s.a)(r,Q.fulfilled,(function(e,t){e.dagStatus="succeeded",e.dagContent=t.payload.dag,e.dagVerbose=t.payload.verbose,e.dagColumn=t.payload.column})),Object(s.a)(r,Q.rejected,(function(e,t){e.dagStatus="failed",e.dagError=t.error.message})),r)}),R=function(e){return e.editor},V=H.actions,W=V.setContentComposed,B=V.setDagLevel,M=V.setEditable,A=V.setFile,F=H.reducer,G=n(792),K=n(793),q=n(38);function U(e){return Object(q.jsx)(d.a,{display:"flex",justifyContent:"center",alignItems:"center",minHeight:e.minHeight,children:Object(q.jsx)(G.a,{in:!0,style:{transitionDelay:"500ms"},unmountOnExit:!0,children:Object(q.jsx)(K.a,{})})})}var J=n(431),Z=n.n(J),Y=n(432),X=n.n(Y);function $(e){var t=e.info?Z.a:X.a;return Object(q.jsx)(d.a,{display:"flex",justifyContent:"center",alignItems:"center",minHeight:e.minHeight,children:Object(q.jsxs)("span",{children:[Object(q.jsx)(t,{color:"primary",fontSize:"large"}),e.message.split("\n").map((function(e){return Object(q.jsx)("p",{children:e})}))]})})}var ee=n(812),te=n(796),ne=n(813),re=n(814),ae=n(795),ie=n(799),oe=n(436),ce=n.n(oe),se=n(437),le=n.n(se),de=n(438),ue=n.n(de),je=n(439),be=n.n(je),fe=n(434),ge=n.n(fe),he=n(435),pe=n.n(he);S.a.use(y.a);var me=Object(ae.a)((function(e){return{speedDial:{position:"absolute",bottom:e.spacing(5),right:e.spacing(2)},floatingButton:{position:"absolute",right:e.spacing(0),bottom:e.spacing(50),zIndex:100}}}));function Oe(e){var t=me(),n=Object(C.b)(),r=Object(C.c)(R),o=i.a.useState(!1),c=Object(l.a)(o,2),s=c[0],d=c[1],j=Object(a.useRef)(null),b={name:"dagre",rankDir:"LR",rankSep:200,nodeSep:50},f={name:"dagre",rankDir:"LR",rankSep:60,nodeSep:15};if(Object(a.useEffect)((function(){if(j.current){var e=j.current._cy;e.on("mouseover","node",(function(t){var n=t.target;if(n.parent().size()>0||0===e.elements().filter((function(e){return e.isParent()})).size()){var r=n.union(n.successors()).union(n.predecessors());r.addClass("highlight"),e.elements().filter((function(e){return e.isChild()})).difference(r).addClass("semitransparent")}var a=n.data().parent_candidates;if(void 0!==a&&a.length>1){var i=a.map((function(e){return[{data:{id:e.name,type:e.type,temporary:!0}},{data:{id:n.data().id+"-"+e.name,source:n.data().id,target:e.name,temporary:!0}}]})).reduce((function(e,t){return e.concat(t)}));if(0===e.elements().filter((function(e){return!0===e.data().temporary})).size()){var o=e.zoom(),c=e.pan();e.add(i),e.elements().filter((function(e){return void 0===e.data().temporary})).lock(),e.elements().filter((function(e){return!0===e.data().temporary||e.data().id===n.data().id})).layout({boundingBox:{x1:n.position().x,y1:n.position().y,w:200,h:200},circle:!0,name:"breadthfirst"}).run(),e.viewport({zoom:o,pan:c})}}})),e.on("mouseout","node",(function(){e.elements().removeClass("semitransparent"),e.elements().removeClass("highlight"),e.remove(e.elements().filter((function(e){return!0===e.data().temporary}))),e.elements().filter((function(e){return void 0===e.data().temporary})).unlock()}))}})),"loading"===r.dagStatus)return Object(q.jsx)(U,{minHeight:e.height});if("failed"===r.dagStatus)return Object(q.jsx)($,{minHeight:e.height,message:r.dagError+"\nPlease check your SQL code for potential syntax error in Script View."});if(0===r.dagContent.length){var g,h=!1;return r.editable?""===r.contentComposed?(g="Welcome to SQLLineage Playground.\nJust paste your SQL in Script View and switch back here, you'll get DAG visualization for your SQL code.\nOr select SQL file on the left directory tree for visualization.\nHave fun!",h=!0):g="No Lineage Info found in your SQL.\nPlease review your code in Script View.":g="No Lineage Info found in SQL file ".concat(r.file,".\nPlease review the code in Script View."),Object(q.jsx)($,{minHeight:e.height,message:g,info:h})}var p={width:e.width,height:e.height};return Object(q.jsxs)("div",{children:[Object(q.jsx)(x.a,{elements:r.dagContent,stylesheet:[{selector:"node",style:{height:10,width:10,content:"data(id)","text-valign":"top","text-halign":"right","font-size":10,color:"#35393e","background-color":"#2fc1d3","border-color":"#000","border-width":1,"border-opacity":.8}},{selector:":parent",style:{content:function(e){return e.data().type+": "+e.data().id},"font-size":16,"font-weight":"bold","text-halign":"center","text-valign":"top"}},{selector:':parent[type = "Table"], :parent[type = "Path"]',style:{"background-color":"#f5f5f5","border-color":"#00516c"}},{selector:':parent[type = "SubQuery"]',style:{"background-color":"#f5f5f5","border-color":"#b46c4f"}},{selector:':parent[type = "Table or SubQuery"]',style:{"background-color":"#f5f5f5","border-color":"#b46c4f","border-style":"dashed"}},{selector:"edge",style:{width:1,"line-color":"#9ab5c7","target-arrow-color":"#9ab5c7","target-arrow-shape":"triangle","arrow-scale":.8,"curve-style":"bezier"}},{selector:".highlight",style:{"background-color":"#076fa1"}},{selector:".semitransparent",style:{opacity:"0.2"}},{selector:"node[temporary]",style:{"background-color":"#f5f5f5","border-color":"#b46c4f","border-style":"dashed",content:function(e){return e.data().type+": "+e.data().id},"font-size":16,"font-weight":"bold",shape:"rectangle","text-halign":"center","text-valign":"top"}},{selector:"edge[temporary]",style:{"line-color":"#b46c4f","line-style":"dashed","target-arrow-color":"#b46c4f"}}],style:p,layout:b,zoom:1,minZoom:.5,maxZoom:2,wheelSensitivity:.2,ref:j}),Object(q.jsxs)(ee.a,{orientation:"vertical",value:r.dagLevel,exclusive:!0,onChange:function(e,t){if(j.current){var a=j.current._cy,i="column"===t?r.dagColumn:r.dagContent,o="column"===t?f:b;a.elements().remove(),a.add(i),a.layout(o).run(),n(B(t))}},"aria-label":"lineage level",className:t.floatingButton,children:[Object(q.jsx)(te.a,{value:"table",children:Object(q.jsx)(u.a,{title:"Table Level Lineage",children:Object(q.jsx)(ge.a,{})})}),Object(q.jsx)(te.a,{value:"column",children:Object(q.jsx)(u.a,{title:"Column Level Lineage",children:Object(q.jsx)(pe.a,{})})})]}),Object(q.jsxs)(ne.a,{ariaLabel:"SpeedDial example",className:t.speedDial,hidden:!1,icon:Object(q.jsx)(re.a,{}),onClose:function(){return d(!1)},onOpen:function(){return d(!0)},open:s,direction:"left",FabProps:{size:"small"},children:[Object(q.jsx)(ie.a,{title:"Save",icon:Object(q.jsx)(ce.a,{}),onClick:function(){if(j.current){var e=j.current._cy,t=document.createElement("a");t.download="".concat(r.file,".jpg"),t.href=e.jpg({full:!0,quality:1}),t.click(),d(!1)}}}),Object(q.jsx)(ie.a,{title:"Zoom In",icon:Object(q.jsx)(le.a,{}),onClick:function(){j.current._cy.zoom(j.current._cy.zoom()+.1)}}),Object(q.jsx)(ie.a,{title:"Auto Fit",icon:Object(q.jsx)(ue.a,{}),onClick:function(){j.current._cy.fit()}}),Object(q.jsx)(ie.a,{title:"Zoom Out",icon:Object(q.jsx)(be.a,{}),onClick:function(){j.current._cy.zoom(j.current._cy.zoom()-.1)}})]})]})}var xe=n(332),ve=n(111);function ye(e){var t=Object(C.b)(),n=Object(C.c)(R),r=new URLSearchParams(Object(ve.e)().search),i=Object(ve.d)();Object(a.useEffect)((function(){var e=r.get("e");if(null!==e)t(W(e)),i.push("/");else{var a=r.get("f");n.file!==a&&(t(A(a)),t(B("table")),null===a?(t(M(!0)),t(Q({e:n.contentComposed}))):(t(M(!1)),t(P({f:a})),t(Q({f:a}))))}}));if("loading"===n.editorStatus)return Object(q.jsx)(U,{minHeight:e.height});if("failed"===n.editorStatus)return Object(q.jsx)($,{minHeight:e.height,message:n.editorError});var o={minimap:{enabled:!1},readOnly:!n.editable,wordWrap:"on",automaticLayout:!0};return Object(q.jsx)(xe.a,{width:e.width,height:e.height,language:"sql",value:n.editable?n.contentComposed:n.content,options:o,editorDidMount:function(e,n){var r=n.editor.EditorOption.readOnly;e.onDidBlurEditorText((function(){e.getOption(r)||(t(W(e.getValue())),t(Q({e:e.getValue()})))})),e.onKeyDown((function(){e.getOption(r)&&e.trigger(n.KeyCode.Backspace,"deleteLeft")}))}})}var we,Se=n(801),Ce=n(802),Le=n(803),Ee=n(445),_e=n.n(Ee),ke=n(446),Ne=n.n(ke),ze=n(760),Te=n(444),Ie=n.n(Te),De=n(44),Pe=function(){var e=Object(_.a)(E.a.mark((function e(t){return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,I.post(T("/directory"),t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Qe=Object(k.b)("directory/fetchDirectory",Pe),He=Object(k.c)({name:"directory",initialState:{content:{},status:"idle",error:null,openNonSQLWarning:!1},reducers:{setOpenNonSQLWarning:function(e,t){e.openNonSQLWarning=t.payload}},extraReducers:(we={},Object(s.a)(we,Qe.pending,(function(e){e.status="loading"})),Object(s.a)(we,Qe.fulfilled,(function(e,t){e.status="succeeded",e.content=t.payload})),Object(s.a)(we,Qe.rejected,(function(e,t){e.status="failed",e.error=t.error.message})),we)}),Re=function(e){return e.directory},Ve=He.actions.setOpenNonSQLWarning,We=He.reducer,Be=n(809),Me=n(800),Ae=n(815),Fe=n(440),Ge=n.n(Fe),Ke=n(441),qe=n.n(Ke),Ue=n(442),Je=n.n(Ue),Ze=n(443),Ye=n.n(Ze),Xe=Object(ae.a)((function(e){return{"@global":{".MuiTreeItem-root.Mui-selected > .MuiTreeItem-content .MuiTreeItem-label":{backgroundColor:"white"}},directory:{marginLeft:e.spacing(.2)},labelRoot:{display:"flex",alignItems:"center",padding:e.spacing(.1,0)},labelIcon:{marginRight:e.spacing(.2)},labelText:{fontWeight:"inherit",flexGrow:1}}}));function $e(e){var t=Xe(),n=Object(ve.d)(),r=Object(C.b)(),o=Object(C.c)(Re),c=i.a.useState(null),s=Object(l.a)(c,2),d=s[0],u=s[1],j=i.a.useState([]),b=Object(l.a)(j,2),f=b[0],g=b[1];Object(a.useEffect)((function(){var t;e.is_root&&(u((null!==(t=o.content.children)&&void 0!==t?t:[]).map((function(e){return Object(q.jsx)($e,{id:e.id,name:e.name,is_dir:e.is_dir,is_root:!1})}))),g([e.id]))}),[o.content.children,e.id,e.is_root]);return Object(q.jsx)(Me.a,{className:t.directory,defaultCollapseIcon:Object(q.jsx)(Ge.a,{}),defaultExpandIcon:Object(q.jsx)(qe.a,{}),expanded:f,onNodeSelect:function(){e.is_dir||(e.name.endsWith(".sql")?n.push("/?f=".concat(e.id)):r(Ve(!0)))},onNodeToggle:function(e,t){var n=t.filter((function(e){return!f.includes(e)}));if(g(t),n[0]){var r=n[0];Pe({d:r}).then((function(e){return u(e.children.map((function(e){return Object(q.jsx)($e,{id:e.id,name:e.name,is_dir:e.is_dir,is_root:!1})})))}))}},children:Object(q.jsx)(Ae.a,{nodeId:e.id,label:Object(q.jsxs)("div",{className:t.labelRoot,children:[e.is_dir?Object(q.jsx)(Je.a,{color:"action",className:t.labelIcon}):Object(q.jsx)(Ye.a,{color:"action",className:t.labelIcon}),Object(q.jsx)(ze.a,{variant:"body2",className:t.labelText,children:e.name})]}),children:e.is_dir&&(d||[Object(q.jsx)("div",{},"stub")])},e.id)})}function et(e){var t=Object(C.b)(),n=Object(C.c)(Re);return Object(a.useEffect)((function(){if("idle"===n.status){var e=new URL(window.location.href);t(Qe(Object.fromEntries(e.searchParams)))}})),"loading"===n.status?Object(q.jsx)(U,{minHeight:e.height}):"failed"===n.status?Object(q.jsx)($,{minHeight:e.height,message:n.error}):Object(q.jsxs)("div",{children:[Object(q.jsx)($e,{id:n.content.id,name:n.content.name,is_dir:!0,is_root:!0}),Object(q.jsx)(Be.a,{anchorOrigin:{vertical:"bottom",horizontal:"left"},open:n.openNonSQLWarning,autoHideDuration:1e3,onClose:function(){t(Ve(!1))},message:"Non SQL File Is Not Supported"})]})}var tt=n(273);function nt(e){var t=Object(C.c)(R);if("loading"===t.dagStatus)return Object(q.jsx)(U,{minHeight:e.height});if("failed"===t.dagStatus)return Object(q.jsx)($,{minHeight:e.height,message:t.dagError+"\nPlease check your SQL code for potential syntax error in Script View."});return Object(q.jsx)(xe.a,{width:e.width,height:e.height,value:t.dagVerbose,options:{minimap:{enabled:!1},readOnly:!0,wordWrap:"on",automaticLayout:!0}})}var rt=Object(ae.a)((function(e){return{appBar:{flexGrow:1,zIndex:e.zIndex.drawer+1},menuButton:{marginRight:e.spacing(2)},title:{flexGrow:1},content:{padding:e.spacing(.5),marginTop:e.spacing(6),float:"right"},hide:{display:"none"},drawerPaper:{width:function(e){return e.drawerWidth+"vw"}},contentShift:{transition:e.transitions.create("margin",{easing:e.transitions.easing.easeOut,duration:e.transitions.duration.enteringScreen})},dragger:{width:"5px",cursor:"ew-resize",position:"absolute",top:0,bottom:0,left:function(e){return e.drawerWidth+"vw"},backgroundColor:"transparent",zIndex:999}}})),at=null;function it(){var e=Object(C.c)(R),t=i.a.useState("dag"),n=Object(l.a)(t,2),r=n[0],o=n[1],c=i.a.useState(!0),O=Object(l.a)(c,2),x=O[0],v=O[1],y=i.a.useState(18),w=Object(l.a)(y,2),S=w[0],L=w[1],E=rt({drawerWidth:S}),_="90vh",k=Object(a.useMemo)((function(){return(x?100-S:100)+"vw"}),[x,S]),N=function(e){if(at){var t=100*e.clientX/window.innerWidth;t>10&&t<50&&L(t)}},z=function e(){at&&(at=!1,document.removeEventListener("mousemove",N),document.removeEventListener("mouseup",e))};return Object(q.jsx)(tt.a,{children:Object(q.jsxs)("div",{children:[Object(q.jsxs)(d.a,{children:[Object(q.jsx)(Se.a,{position:"fixed",className:E.appBar,children:Object(q.jsxs)(Ce.a,{variant:"dense",children:[Object(q.jsx)(Le.a,{edge:"start",className:E.menuButton,color:"inherit","aria-label":"menu",onClick:function(){v(!x)},children:x?Object(q.jsx)(Ie.a,{}):Object(q.jsx)(_e.a,{})}),Object(q.jsx)(ze.a,{variant:"h6",className:E.title,children:"SQLLineage"}),e.editable?Object(q.jsx)(u.a,{title:"Visualize Lineage By Filling In Your Own SQL",arrow:!0,children:Object(q.jsx)("div",{children:"Composing Mode"})}):Object(q.jsx)(tt.b,{to:"/",style:{color:"white"},children:Object(q.jsx)(u.a,{title:"Enter Composing Mode to Visualize Your Own SQL",arrow:!0,children:Object(q.jsx)(Le.a,{color:"inherit",onClick:function(){o("script"),v(!1)},children:Object(q.jsx)(Ne.a,{})})})})]})}),Object(q.jsx)(j.a,{variant:"persistent",open:x,classes:{paper:E.drawerPaper},children:Object(q.jsx)(d.a,{className:E.content,children:Object(q.jsx)(et,{})})})]}),Object(q.jsx)("div",{id:"dragger",onMouseDown:function(e){e.stopPropagation(),e.preventDefault(),document.addEventListener("mousemove",N),document.addEventListener("mouseup",z),at=!0},className:Object(De.a)(E.dragger,Object(s.a)({},E.hide,!x))}),Object(q.jsxs)("main",{className:Object(De.a)(E.content,Object(s.a)({},E.contentShift,x)),children:[Object(q.jsxs)(b.a,{elevation:"24",style:{height:_,width:k},children:[Object(q.jsx)(d.a,{className:"dag"===r?"":E.hide,children:Object(q.jsx)(Oe,{height:_,width:k})}),Object(q.jsx)(d.a,{className:"text"===r?"":E.hide,children:Object(q.jsx)(nt,{height:_,width:k})}),Object(q.jsx)(d.a,{className:"script"===r?"":E.hide,children:Object(q.jsx)(ye,{height:_,width:k})})]}),Object(q.jsx)(f.a,{container:!0,justify:"center",children:Object(q.jsx)(g.a,{component:"fieldset",children:Object(q.jsxs)(h.a,{row:!0,"aria-label":"position",name:"position",defaultValue:"dag",value:r,onChange:function(e){return o(e.target.value)},children:[Object(q.jsx)(p.a,{value:"dag",control:Object(q.jsx)(m.a,{color:"primary"}),label:"Lineage View"}),Object(q.jsx)(p.a,{value:"text",control:Object(q.jsx)(m.a,{color:"primary"}),label:"Text View"}),Object(q.jsx)(p.a,{value:"script",control:Object(q.jsx)(m.a,{color:"primary"}),label:"Script View"})]})})})]})]})})}var ot=Object(k.a)({reducer:{directory:We,editor:F}});c.a.render(Object(q.jsx)(i.a.StrictMode,{children:Object(q.jsx)(C.a,{store:ot,children:Object(q.jsx)(it,{})})}),document.getElementById("root"))}},[[741,1,2]]]);
//# sourceMappingURL=main.c70db286.chunk.js.map