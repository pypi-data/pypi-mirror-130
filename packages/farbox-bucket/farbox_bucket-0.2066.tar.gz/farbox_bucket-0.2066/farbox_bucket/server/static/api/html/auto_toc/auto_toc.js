// Generated by CoffeeScript 1.8.0
(function() {
  var get_toc_default_top;

  get_toc_default_top = function() {
    return $('.doc_toc').offset().top || 0;
  };

  $(document).ready((function(_this) {
    return function() {
      var current_active_class, remove_current_toc_active_class, toc_element, toc_selector;
      toc_selector = '.doc_toc';
      current_active_class = 'current_active';
      toc_element = $(toc_selector);
      $('.doc_toc a').click(function() {
        var new_hash_name, scroll_to_y, toc_content_dom, toc_content_dom_id, y;
        toc_content_dom_id = $(this).attr('href').slice(1);
        if (toc_content_dom_id) {
          toc_content_dom = $('#' + toc_content_dom_id);
          y = toc_content_dom.offset().top;
          scroll_to_y = y;
          if (scroll_to_y < 0) {
            scroll_to_y = 0;
          }
          $('body,html').animate({
            scrollTop: scroll_to_y
          }, 800);
          new_hash_name = '#' + toc_content_dom_id;
          if (history.pushState) {
            history.pushState(null, null, new_hash_name);
          } else {
            window.location.hash = new_hash_name;
          }
          return false;
        }
      });
      remove_current_toc_active_class = function() {
        return $(toc_selector + ' .' + current_active_class).removeClass(current_active_class);
      };
      toc_element.on('activate.bs.scrollspy', function() {
        var current_active_element;
        current_active_element = $(toc_selector + ' .active').last();
        remove_current_toc_active_class();
        return current_active_element.addClass(current_active_class);
      });
      toc_element.on('clear.bs.scrollspy', remove_current_toc_active_class);
      $('.doc_toc_container').affix({
        offset: {
          top: (typeof toc_offset_top !== "undefined" && toc_offset_top !== null ? toc_offset_top : void 0) || get_toc_default_top(),
          bottom: (typeof toc_offset_bottom !== "undefined" && toc_offset_bottom !== null ? toc_offset_bottom : void 0) || 0
        }
      });
      $(document).on('affixed.bs.affix', function() {
        var height;
        height = (document.body.clientHeight - 100) || 'auto';
        return $('.doc_toc').css('max-height', height);
      });
      $('body').scrollspy({
        target: toc_selector
      });
      if ($(window).width() < 480) {
        return $('.doc_toc').css('display', 'none');
      }
    };
  })(this));

}).call(this);
