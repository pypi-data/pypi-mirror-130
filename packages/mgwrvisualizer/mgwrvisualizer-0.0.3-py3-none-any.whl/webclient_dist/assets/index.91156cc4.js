var ee=Object.defineProperty,te=Object.defineProperties;var se=Object.getOwnPropertyDescriptors;var P=Object.getOwnPropertySymbols;var ae=Object.prototype.hasOwnProperty,oe=Object.prototype.propertyIsEnumerable;var L=(e,t,s)=>t in e?ee(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,x=(e,t)=>{for(var s in t||(t={}))ae.call(t,s)&&L(e,s,t[s]);if(P)for(var s of P(t))oe.call(t,s)&&L(e,s,t[s]);return e},$=(e,t)=>te(e,se(t));import{g as le,d as G,o as w,r as ne,a as i,c as A,w as T,b as D,P as re,e as u,f as c,t as f,h as N,F as b,i as S,B as k,j as g,u as d,k as V,n as F,l as ce,m as B,p as M,D as ie,q as O,s as R,v as U,G as ue,x as W,R as de,y as z,z as pe,A as _e,C as fe,E as ge,H as ye,I as he}from"./vendor.fe90d8ec.js";const me=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))a(o);new MutationObserver(o=>{for(const n of o)if(n.type==="childList")for(const l of n.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&a(l)}).observe(document,{childList:!0,subtree:!0});function s(o){const n={};return o.integrity&&(n.integrity=o.integrity),o.referrerpolicy&&(n.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?n.credentials="include":o.crossorigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function a(o){if(o.ep)return;o.ep=!0;const n=s(o);fetch(o.href,n)}};me();const ve=async()=>{const e=_(),t=h(),s=e.getSelectedNumberClasses-1,a=t.getSelectedAttributeData||[],o=e.getClassificationType;return await le(o,a,s)},m={BANDWITH:"BW",ATTRIBUTE:"AT"},I={MODEL_RESULTS:"MR",DIAGNOSTIC_INFO:"DI"},_=G("selectionStore",{state:()=>({vizualizationType:m.BANDWITH,modelResultsType:I.MODEL_RESULTS,selectedK:null,selectedUID:null,selectedAttribute:null,selectedNumberClasses:7,classificationType:"JNK",classificationBuckets:null,colorRamp:[[230,171,2],[217,95,2],[117,112,179],[231,41,138],[102,166,30],[230,171,2],[166,118,29],[102,102,102]]}),getters:{getVizualizationType(e){return e.vizualizationType},getModelResultsType(e){return e.modelResultsType},getSelectedK(e){return e.selectedK},getSelectedAttribute(e){return e.selectedAttribute},getCurrentUID(e){return e.selectedUID},getClassificationBuckets(e){return e.classificationBuckets},getSelectedNumberClasses(e){return e.selectedNumberClasses},getColorRamp(e){return e.colorRamp},getCategoricalBuckets(e){return e.classificationBuckets},getClassificationType(e){return e.classificationType}},actions:{async generateBuckets(){console.log("DISPATCHING");const e=await ve();this.classificationBuckets=e}}}),h=G("dataStore",{state:()=>({geoJsonData:{type:"FeatureCollection",features:[]},W:{},params:{},covaraites:{},diagnosticInfo:{},modelResults:{}}),getters:{getGeoJsonData(e){return e.geoJsonData},getW(e){return e.W},getCovariateKeys(e){return Object.keys(e.covaraites)},getCovariateInfo(e){return e.covaraites},getGeoJsonPropertyKeys(e){return Object.keys(e.geoJsonData.features[0].properties)},getSelectedAttributeData(e){const s=_().getSelectedAttribute;return e.geoJsonData.features.map(a=>a.properties[s])},getSelectedCovariateInfo(e){const s=_().getSelectedK||"K0";return e.covaraites[s]},getParams(e){return e.params},getDiagnosticInformation(e){return e.diagnosticInfo},getModelResults(e){return e.modelResults}},actions:{async loadData(e){const t=await fetch(e);if(t.ok){const s=await t.json();this.setData(s)}else console.error("Data fetching error")},async setData(e){this.geoJsonData=e.geojson,this.W=e.W,this.params=e.parameters,this.covaraites=e.covariates,this.diagnosticInfo=e.diagnosticInfo,this.modelResults=e.modelResults}}});const xe={setup(e){const t=h();return _(),w(async()=>{const a=new URLSearchParams(window.location.search).get("name");if(a==="local")t.loadData("http://localhost:8000/data.json");else if(a==="file")console.log("Setting from file");else try{console.log("Not local")}catch{console.error("Error fetching non-local dataset")}}),(s,a)=>{const o=ne("router-view");return i(),A(o,{class:"min-h-screen w-screen overflow-x-hidden"})}}},be={responsive:!0},Se={autosize:!0,xaxis:{automargin:!0},yaxis:{automargin:!0}},ke={name:"Sig (+)",x:[],y:[],error_y:{type:"data",array:[],visible:!0,thickness:1.5,color:"rgb(255,99,71)",width:3,opacity:1},marker:{color:"#808080",size:8},type:"scatter"},Ce={name:"Sig (-)",x:[],y:[],error_y:{type:"data",array:[],visible:!0,thickness:1.5,color:"#0000ff",width:3,opacity:1},marker:{color:"#808080",size:8},type:"scatter"},we={name:"Insig",x:[],y:[],error_y:{type:"data",array:[],visible:!0,thickness:1.5,color:"#808080",width:2,opacity:1},marker:{color:"#808080",size:8},type:"scatter"},Te={class:"h-full w-full"},Ie=c("div",{id:"graph",class:"w-full h-full"},null,-1),$e=[Ie],Ae={setup(e){const t=h(),s=_();T(()=>[s.selectedK],(l,r)=>{n()},{deep:!0});const a=D(()=>t.getParams.critical);w(()=>{n()});const o=(l,r)=>{let p=x({},l);return p.x=r.map(y=>y.x),p.y=r.map(y=>y.y),p.error_y.array=r.map(y=>parseFloat(y.error)),p},n=()=>{const r=(t.getParams[s.getSelectedK||"K0"]||[]).sort((v,Z)=>v.y-Z.y),p=r.filter(v=>v.ctval<-1*a.value),y=o(Ce,p),H=r.filter(v=>v.ctval>a.value),Q=o(ke,H),X=r.filter(v=>v.ctval>-1*a.value&&v.ctval<a.value),Y=o(we,X);re.newPlot("graph",[y,Q,Y],Se,be)};return(l,r)=>(i(),u("div",Te,$e))}};var E=(e,t)=>{for(const[s,a]of t)e[s]=a;return e};const De={class:"w-full max-w-xs px-3 py-2 w-60 font-medium"},Ne={key:0,disabled:"disabled",selected:"selected"},Be=["value"],Re={props:{placeholder:{type:String,required:!1,default:null},data:{type:Array,required:!0},keyBy:{type:String,required:!1,default:null},labelBy:{type:String,required:!1,default:null}},setup(e){return(t,s)=>(i(),u("select",De,[e.placeholder?(i(),u("option",Ne,f(e.placeholder),1)):N("",!0),(i(!0),u(b,null,S(e.data,a=>(i(),u("option",{key:e.keyBy?a[e.keyBy]:a,value:e.keyBy?a[e.keyBy]:a,class:""},f(e.labelBy?a[e.labelBy]:a),9,Be))),128))]))}};var K=E(Re,[["__scopeId","data-v-8a0b8e4c"]]);const ze=["min","max","value"],Ee={props:{min:{type:Number,required:!1,default:0},max:{type:Number,required:!1,default:100},defaultVal:{type:Number,required:!1,default:5}},setup(e){return(t,s)=>(i(),u("input",{type:"range",min:e.min,max:e.max,value:e.defaultVal,class:"slider"},null,8,ze))}};var Ke=E(Ee,[["__scopeId","data-v-a12b3fd0"]]);const j={SATELLITE:"mapbox://styles/mapbox/satellite-v9",DARK:"mapbox://styles/mapbox/dark-v10"},C={latitude:36,longitude:-80,zoom:4,pitch:0,bearing:0},je={container:"map",width:"100%",style:j.DARK,interactive:!1,center:[C.longitude,C.latitude],zoom:C.zoom,bearing:C.bearing,pitch:C.pitch},Pe={canvas:"deck-canvas",width:"100%",height:"100%",controller:!0,initialViewState:C},Le=[{label:"Equal Interval",value:k.EQI},{label:"Quantile",value:k.QNT},{label:"Standard Deviation",value:k.STD},{label:"Geometric Progession",value:k.GPG},{label:"Arithmetic Progression",value:k.APG},{label:"Jenks",value:k.JNK}];const Ge={class:"h-full w-full flex flex-col space-y-4"},Ve=c("p",{class:"text-2xl font-bold"}," Attribute ",-1),Fe={class:"flex flex-col space-y-4 justify-evenly"},Me={class:"flex flex-row space-x-2 md:space-x-10 items-center justify-evenly"},Oe=c("p",{class:"w-full text-left"}," Attribute ",-1),Ue={class:"flex flex-row space-x-2 md:space-x-10 items-center justify-evenly"},We=c("p",{class:"w-full text-left"}," Classification Scheme ",-1),qe={class:"flex flex-row space-x-2 md:space-x-10 items-center justify-evenly"},Je=c("p",{class:"w-full text-left"}," Number of Classes ",-1),He={class:"w-1/2 flex-shrink"},Qe={setup(e){const t=h(),s=_();let a=10;const o=r=>{s.selectedAttribute=r.target.value,s.generateBuckets()},n=r=>{s.classificationType=r.target.value,s.generateBuckets()},l=r=>{s.selectedNumberClasses=r.target.value,s.generateBuckets()};return(r,p)=>(i(),u("div",Ge,[Ve,c("div",Fe,[c("div",Me,[Oe,g(K,{data:d(t).getGeoJsonPropertyKeys,placeholder:"Select Attr",class:"flex-shrink",onChange:o},null,8,["data"])]),c("div",Ue,[We,g(K,{data:d(Le),"label-by":"label","key-by":"value",placeholder:"Select Method",class:"flex-shrink",onChange:n},null,8,["data"])]),c("div",qe,[Je,c("div",He,[g(Ke,{modelValue:d(a),"onUpdate:modelValue":p[0]||(p[0]=y=>V(a)?a.value=y:a=y),min:2,max:8,class:"flex-shrink-0 slider",onChange:l},null,8,["modelValue"])])])])]))}};const Xe={class:"min-w-30 md:min-w-48 bg-white z-50 w-40 flex justify-center flex-col"},Ye={key:0,class:"py-1 md:py-2"},Ze={class:"text"},et={key:1,class:"py-1 md:py-2"},tt={class:"text"},st={setup(e){const t=_(),s=[0,.05,.1,.2,.3,.4,.5,.6,.7,.8,.9],a=o=>{const n=t.getColorRamp[o],l=n[0],r=n[1],p=n[2];return`rgb(${l}, ${r}, ${p})`};return(o,n)=>(i(),u("div",Xe,[d(t).getVizualizationType==d(m).ATTRIBUTE&&d(t).getSelectedAttribute!=null?(i(),u("div",Ye,[(i(!0),u(b,null,S(d(t).getCategoricalBuckets,(l,r)=>(i(),u("div",{key:r,class:"key"},[c("div",Ze,f(d(t).getCategoricalBuckets[r-1]?d(t).getCategoricalBuckets[r-1].toFixed(2).toString():"min")+" - "+f(l.toFixed(2).toString()),1),c("div",{class:"color",style:F({"background-color":a(r)})},null,4)]))),128))])):N("",!0),d(t).getVizualizationType==d(m).BANDWITH?(i(),u("div",et,[(i(),u(b,null,S(s,(l,r)=>c("div",{key:r,class:"key"},[c("div",tt,f(s[r]?s[r-1]:"0")+" - "+f(l),1),c("div",{class:"color",style:F({"background-color":d(ce).interpolateReds(l)})},null,4)])),64))])):N("",!0)]))}},at={class:"relative h-full w-full"},ot={class:"h-full w-full absolute top-0 left-0"},lt=c("canvas",{id:"deck-canvas",class:"h-full w-full absolute top-0 left-0"},null,-1),nt={setup(e){_();const t=B();let s=null;const a=M({latitude:36.102376,longitude:-80.649277,zoom:4,pitch:0,bearing:0});w(()=>{s=new ie(x(x({onViewStateChange:({viewState:l})=>o(l)},Pe),t))});function o(l){a.longitude=l.longitude,a.latitude=l.latitude,a.zoom=l.zoom}function n(l){if(!s){console.log("NO DECK");return}s.setProps({layers:[l]})}return O("viewState",a),O("updateLayer",n),(l,r)=>(i(),u("div",at,[c("div",ot,[R(l.$slots,"default"),lt])]))}},rt={emits:["click","hover"],setup(e,{emit:t}){const s=B(),a=U("updateLayer"),o=_();n(),T(()=>[s,o.getCurrentUID,o.getSelectedK,o.getClassificationBuckets],()=>{n()},{deep:!1});function n(){a(new ue($(x({id:"geojson-layer"},s),{updateTriggers:{getFillColor:[o.getCurrentUID,o.getSelectedK,o.getSelectedNumberClasses,o.getClassificationType,o.getSelectedAttribute]},onClick:(l,r)=>t("click",{info:l,event:r}),onHover:(l,r)=>t("hover",{info:l,event:r})})))}return(l,r)=>null}},ct={props:{accessToken:{type:String,required:!0},mapStyle:{type:String,required:!1,default:null}},setup(e){const t=e;let s=null;const a=B(),o=U("viewState");w(()=>{W.accessToken=t.accessToken,s=new W.Map($(x(x({},je),a),{style:t.mapStyle||j.dark}))}),T(()=>o,(l,r)=>{n(l)},{deep:!0});function n(l){s.jumpTo({center:[l.longitude,l.latitude],zoom:l.zoom,bearing:l.bearing,pitch:l.pitch})}return(l,r)=>(i(),u("div",{id:"map",ref:(p,y)=>{y.map=p,V(s)?s.value=p:s=p},class:"w-full h-full absolute top-0 left-0 overflow-hidden"},null,512))}},it=e=>{const s=_().getVizualizationType;let a;switch(s){case m.BANDWITH:{a=ut(e.properties.UID);break}case m.ATTRIBUTE:{a=dt(e.properties);break}default:{a=[0,0,0,0];break}}return a},ut=e=>{const t=_(),s=h(),a=t.getCurrentUID,o=t.getSelectedK,n=s.getW;return!a||!n||n[o][a][e]<=0?[0,0,0,0]:de(n[o][a][e]).match(/\d+/g).map(Number)},dt=e=>{const t=_(),s=t.getCategoricalBuckets,a=t.getColorRamp,o=t.getSelectedAttribute,n=e[o];if(!s||!a||!o||!n)return[0,0,0,0];for(const[l,r]of s.entries())if(n<=r)return a[l]},pt={class:"relative h-full w-full"},_t={setup(e){const t=h(),s=_(),a="pk.eyJ1IjoibXRyYWxrYSIsImEiOiJja2VjNm5hdWEwNjQ4MnZ0cHlycXlndnN5In0.mfQAFUPzfGZeMht0EToJBA";let o=M({data:null});s.getCurrentUID,s.getSelectedK,s.getCurrentUID,s.getCurrentK,w(()=>{o.data=t.getGeoJsonData}),T(()=>[t.getGeoJsonData],()=>{o.data=t.getGeoJsonData},{deep:!1});const n=({info:r,event:p})=>{!r.object||s.getVizualizationType==m.BANDWITH&&(s.selectedUID=r.object.properties.UID)},l=({info:r,event:p})=>{};return(r,p)=>(i(),u("div",pt,[g(nt,null,{default:z(()=>[g(ct,{"access-token":a,"map-style":d(j).DARK},null,8,["map-style"]),g(rt,{data:d(o).data,pickable:!0,stroked:!0,filled:!0,extruded:!1,wireframe:!0,lineWidthScale:20,lineWidthMinPixels:2,getRadius:100,getLineWidth:1,getFillColor:d(it),getLineColor:[160,160,180,200],onHover:n,onClick:l},null,8,["data","getFillColor"])]),_:1}),R(r.$slots,"default")]))}},ft={class:"flex flex-row items-center space-x-2"},gt={class:"cursor-pointer label space-x-3"},yt=["name","checked","value"],ht={props:{groupName:{type:String,required:!0},checked:{type:Boolean,required:!0,default:!1},value:{type:String||Object||Number,required:!0}},setup(e){return(t,s)=>(i(),u("div",ft,[c("label",gt,[R(t.$slots,"default")]),c("input",{type:"radio",name:e.groupName,checked:e.checked,class:"radio radio-primary",value:e.value},null,8,yt)]))}},mt={class:"h-full w-full text-black flex flex-col items-center justify-center space-y-2"},vt={class:"w-full bg-gray-400 flex justify-center py-2"},xt={class:"flex flex-row space-x-4 font-bold font-medium flex-shrink-0 flex-grow-0 items-center"},bt={class:"font-bold text-lg"},q={props:{name:{type:String,required:!0},data:{type:Array,required:!0},component:{required:!0}},emits:["change"],setup(e,{emit:t}){const s=a=>{t("change",a.target.value)};return(a,o)=>(i(),u("div",mt,[c("div",vt,[c("div",xt,[c("p",bt,f(e.name),1),(i(!0),u(b,null,S(e.data,n=>(i(),A(ht,{"v-key":n.name,"group-name":e.name,value:n.value,checked:n.checked,onChange:s},{default:z(()=>[_e(f(n.name),1)]),_:2},1032,["v-key","group-name","value","checked"]))),256))])]),(i(),A(pe(e.component),{class:"flex-grow py-2 px-4"}))]))}},St={class:"h-full w-full flex flex-col space-y-4"},kt={class:"flex flex-row space-x-2 items-center justify-evenly"},Ct=c("p",{class:"font-bold text-lg"}," Covariate (K) ",-1),wt={setup(e){const t=h(),s=_(),a=o=>{s.selectedK=o.target.value};return(o,n)=>(i(),u("div",St,[c("div",kt,[Ct,g(K,{data:d(t).getCovariateKeys,placeholder:"Select K",onChange:a},null,8,["data"])])]))}};const Tt={class:"h-full w-full flex flex-col space-y-4 items-center"},It={class:""},$t={class:"w-full px-4 text-gray-800"},At={class:"px-4 min-w-[100px]"},Dt={setup(e){const t=h();return(s,a)=>(i(),u("div",Tt,[g(wt),c("table",It,[(i(!0),u(b,null,S(d(t).getSelectedCovariateInfo,(o,n,l)=>(i(),u("tr",{key:l,class:"flex flex-row space-x-2 justify-evenly"},[c("td",$t,f(n),1),c("td",At,f(parseFloat(o).toFixed(4)),1)]))),128))])]))}};const Nt={class:"h-full w-full flex flex-col space-y-4 items-center"},Bt={class:""},Rt={class:"w-full px-4 text-gray-800"},zt={class:"px-4 min-w-[100px]"},Et={setup(e){const t=h();return(s,a)=>(i(),u("div",Nt,[c("table",Bt,[(i(!0),u(b,null,S(d(t).getDiagnosticInformation,(o,n,l)=>(i(),u("tr",{key:l,class:"flex flex-row space-x-2 justify-evenly"},[c("td",Rt,f(n),1),c("td",zt,f(parseFloat(o).toFixed(4)),1)]))),128))])]))}};const Kt={class:"h-full w-full flex flex-col space-y-4 items-center"},jt={class:""},Pt={class:"w-full px-4 text-gray-800"},Lt={class:"px-1 min-w-[100px]"},Gt={setup(e){const t=h();return(s,a)=>(i(),u("div",Kt,[c("table",jt,[(i(!0),u(b,null,S(d(t).getModelResults,(o,n,l)=>(i(),u("tr",{key:l,class:"flex flex-row space-x-2 justify-evenly"},[c("td",Pt,f(n),1),c("td",Lt,f(o),1)]))),128))])]))}};const Vt={class:"w-full min-h-full px-3 md:px-10 overflow-hidden"},Ft={class:"w-full min-h-full grid-cols-2 grid gap-1.5rem py-10"},Mt={class:"col-span-full row-span-2 h-[32rem] relative"},Ot={class:"col-span-full md:col-span-1 md:row-span-1 box"},Ut={class:"col-span-full md:col-span-1 md:row-span-1 box"},Wt={class:"col-span-full row-span-2 h-[32rem] box"},qt={setup(e){const t=_(),s=D(()=>t.getVizualizationType===m.ATTRIBUTE?Qe:Dt),a=[{value:m.BANDWITH,checked:!0,name:"Bandwith"},{value:m.ATTRIBUTE,checked:!1,name:"Attribute"}],o=D(()=>t.getModelResultsType===I.DIAGNOSTIC_INFO?Et:Gt),n=[{value:I.MODEL_RESULTS,checked:!0,name:"Model"},{value:I.DIAGNOSTIC_INFO,checked:!1,name:"Diagnostic"}];return(l,r)=>(i(),u("div",Vt,[c("div",Ft,[c("div",Mt,[g(_t,null,{default:z(()=>[g(st,{class:"absolute right-10 bottom-10 z-50"})]),_:1})]),c("div",Ot,[g(q,{data:n,name:"Results:",component:d(o),onChange:r[0]||(r[0]=p=>d(t).modelResultsType=p)},null,8,["component"])]),c("div",Ut,[g(q,{data:a,name:"Visualize:",component:d(s),onChange:r[1]||(r[1]=p=>d(t).vizualizationType=p)},null,8,["component"])]),c("div",Wt,[g(Ae)])])]))}};var J=E(qt,[["__scopeId","data-v-03a5a1d8"]]);const Jt=[{path:"/",name:"Hello Worlds",component:J},{path:"/visualize",name:"Visualize",component:J}],Ht=fe({history:ge(),routes:Jt});ye(xe).use(Ht).use(he()).mount("#app");
