---

title: webrefine


keywords: fastai
sidebar: home_sidebar

summary: "A workflow for refining web pages into useful datasets."
description: "A workflow for refining web pages into useful datasets."
nb_path: "nbs/index.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/index.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Read the <a href="https://edwardjross.github.io/webrefine/">full documentation</a></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Install">Install<a class="anchor-link" href="#Install"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>pip install webrefine</code></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="How-to-use">How to use<a class="anchor-link" href="#How-to-use"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We'll go through an example of getting some titles from my blog at <a href="https://skeptric.com">skeptric.com</a>.</p>
<p>The process consists of:</p>
<ul>
<li>Defining Queries</li>
<li>Defining Extraction and Filters</li>
<li>Running the process</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Querying-data">Querying data<a class="anchor-link" href="#Querying-data"> </a></h3><p>To start we'll need some captures of my blog, and so we'll get them from the Internet Archive's Wayback Machine.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">webrefine.query</span> <span class="kn">import</span> <span class="n">WaybackQuery</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We could get some HTML pages:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">skeptric_wb</span> <span class="o">=</span> <span class="n">WaybackQuery</span><span class="p">(</span><span class="s1">&#39;skeptric.com/*&#39;</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="s1">&#39;2020&#39;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;2020&#39;</span><span class="p">,</span> <span class="n">mime</span><span class="o">=</span><span class="s1">&#39;text/html&#39;</span><span class="p">)</span>
<span class="n">sample</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">skeptric_wb</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">limit</span><span class="o">=</span><span class="mi">20</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can get some sample records</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sample</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>WaybackRecord(url=&#39;https://skeptric.com/&#39;, timestamp=datetime.datetime(2020, 11, 26, 6, 41, 2), mime=&#39;text/html&#39;, status=200, digest=&#39;WDYU3RU7ZMFFSZPAPE56PC4L3EK4FE3D&#39;)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sample</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>WaybackRecord(url=&#39;https://skeptric.com/casper-2-to-3/&#39;, timestamp=datetime.datetime(2020, 11, 26, 7, 52, 8), mime=&#39;text/html&#39;, status=200, digest=&#39;3XDBGHY77ZEA2Z7IVBARXEQT6UDLYAL7&#39;)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>And view them on the Wayback Machine to work out how to get the information we want</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sample</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">preview</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<a href="http://web.archive.org/web/20201126075208/https://skeptric.com/casper-2-to-3/">http://web.archive.org/web/20201126075208/https://skeptric.com/casper-2-to-3/</a>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We could also query CommonCrawl similarly with a <a href="/webrefine/query.html#CommonCrawlQuery"><code>CommonCrawlQuery</code></a>.
This has more captures but takes a bit longer to run.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">webrefine.query</span> <span class="kn">import</span> <span class="n">CommonCrawlQuery</span>
<span class="n">skeptric_cc</span> <span class="o">=</span> <span class="n">CommonCrawlQuery</span><span class="p">(</span><span class="s1">&#39;skeptric.com/*&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Another option is to add local Warc Files (e.g. produced using <code>warcio</code> or <code>wget</code> with <code>warc</code> parameters)</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">webrefine.query</span> <span class="kn">import</span> <span class="n">WarcFileQuery</span>
<span class="n">test_data</span> <span class="o">=</span> <span class="s1">&#39;../resources/test/skeptric.warc.gz&#39;</span>

<span class="n">skeptric_file_query</span> <span class="o">=</span> <span class="n">WarcFileQuery</span><span class="p">(</span><span class="n">test_data</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="p">[</span><span class="n">r</span><span class="o">.</span><span class="n">url</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">skeptric_file_query</span><span class="o">.</span><span class="n">query</span><span class="p">()]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[&#39;https://skeptric.com/pagination-wayback-cdx/&#39;,
 &#39;https://skeptric.com/robots.txt&#39;,
 &#39;https://skeptric.com/style.main.min.5ea2f07be7e07e221a7112a3095b89d049b96c48b831f16f1015bf2d95d914e5.css&#39;,
 &#39;https://skeptric.com/&#39;,
 &#39;https://skeptric.com/about/&#39;,
 &#39;https://skeptric.com/tags/data&#39;,
 &#39;https://skeptric.com/tags/data/&#39;,
 &#39;https://skeptric.com/images/wayback_empty_returns.png&#39;,
 &#39;https://skeptric.com/searching-100b-pages-cdx&#39;,
 &#39;https://skeptric.com/searching-100b-pages-cdx/&#39;,
 &#39;https://skeptric.com/fast-web-data-workflow/&#39;,
 &#39;https://skeptric.com/key-web-captures/&#39;,
 &#39;https://skeptric.com/emacs-tempfile-hugo/&#39;]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Filtering-and-Extracting-the-Data">Filtering and Extracting the Data<a class="anchor-link" href="#Filtering-and-Extracting-the-Data"> </a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>From Inspecting some web results we can see that the titles are written like:</p>
<div class="highlight"><pre><span></span><span class="p">&lt;</span><span class="nt">h1</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;post-full-title&quot;</span><span class="p">&gt;</span>{TITLE}<span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>
</pre></div>
<p>In a real example we'd parse the HTML, but for simplicity we'll extract it with a regular expression</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">re</span>
<span class="k">def</span> <span class="nf">skeptric_extract</span><span class="p">(</span><span class="n">content</span><span class="p">,</span> <span class="n">record</span><span class="p">):</span>
    <span class="n">html</span> <span class="o">=</span> <span class="n">content</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>
    <span class="n">title</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">finditer</span><span class="p">(</span><span class="s1">&#39;&lt;h1 class=&quot;post-full-title&quot;&gt;([^&lt;]+)&lt;/h1&gt;&#39;</span><span class="p">,</span> <span class="n">html</span><span class="p">))</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">{</span>
        <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="n">title</span><span class="p">,</span>
        <span class="s1">&#39;url&#39;</span><span class="p">:</span> <span class="n">record</span><span class="o">.</span><span class="n">url</span><span class="p">,</span>
        <span class="s1">&#39;timestamp&#39;</span><span class="p">:</span> <span class="n">record</span><span class="o">.</span><span class="n">timestamp</span>
    <span class="p">}</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can then test it on some content we fetch from the Wayback Machine</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">skeptric_extract</span><span class="p">(</span><span class="n">sample</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">content</span><span class="p">,</span> <span class="n">sample</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{&#39;title&#39;: &#39;Hugo Casper 2 to 3&#39;,
 &#39;url&#39;: &#39;https://skeptric.com/casper-2-to-3/&#39;,
 &#39;timestamp&#39;: datetime.datetime(2020, 11, 26, 7, 52, 8)}</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Some pages don't have it so we filter them out, and we remove duplicates</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">skeptric_filter</span><span class="p">(</span><span class="n">records</span><span class="p">):</span>
    <span class="n">last_url</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">for</span> <span class="n">record</span> <span class="ow">in</span> <span class="n">records</span><span class="p">:</span>
        <span class="c1"># Only use ok HTML captures</span>
        <span class="k">if</span> <span class="n">record</span><span class="o">.</span><span class="n">mime</span> <span class="o">!=</span> <span class="s1">&#39;text/html&#39;</span> <span class="ow">or</span> <span class="n">record</span><span class="o">.</span><span class="n">status</span> <span class="o">!=</span> <span class="mi">200</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="c1"># Pages that are not articles (and so do not have a title)</span>
        <span class="k">if</span> <span class="n">record</span><span class="o">.</span><span class="n">url</span> <span class="o">==</span> <span class="s1">&#39;https://skeptric.com/&#39;</span> <span class="ow">or</span> <span class="s1">&#39;/tags/&#39;</span> <span class="ow">in</span> <span class="n">record</span><span class="o">.</span><span class="n">url</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="c1"># Duplicates (using the fact that here the posts come in order)</span>
        <span class="k">if</span> <span class="n">record</span><span class="o">.</span><span class="n">url</span> <span class="o">==</span> <span class="n">last_url</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="n">last_url</span> <span class="o">=</span> <span class="n">record</span><span class="o">.</span><span class="n">url</span>
        <span class="k">yield</span> <span class="n">record</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="p">[</span><span class="n">r</span><span class="o">.</span><span class="n">url</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">skeptric_filter</span><span class="p">(</span><span class="n">sample</span><span class="p">)]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[&#39;https://skeptric.com/casper-2-to-3/&#39;,
 &#39;https://skeptric.com/common-crawl-index-athena/&#39;,
 &#39;https://skeptric.com/common-crawl-job-ads/&#39;,
 &#39;https://skeptric.com/considering-vscode/&#39;,
 &#39;https://skeptric.com/decorating-pandas-tables/&#39;,
 &#39;https://skeptric.com/drive-metrics/&#39;,
 &#39;https://skeptric.com/emacs-buffering/&#39;,
 &#39;https://skeptric.com/ngram-python/&#39;,
 &#39;https://skeptric.com/portable-custom-config/&#39;,
 &#39;https://skeptric.com/searching-100b-pages-cdx/&#39;,
 &#39;https://skeptric.com/text-meta-data-commoncrawl/&#39;]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Running-the-process">Running the process<a class="anchor-link" href="#Running-the-process"> </a></h2><p>Now we've written all the logic we need, we can collect it all in a process to run</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">webrefine.runners</span> <span class="kn">import</span> <span class="n">ProcessMemory</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">skeptric_process</span> <span class="o">=</span> <span class="n">ProcessMemory</span><span class="p">(</span>
    <span class="n">queries</span><span class="o">=</span><span class="p">[</span><span class="n">skeptric_file_query</span><span class="p">,</span>
             <span class="c1"># commented out to make faster</span>
             <span class="c1">#skeptric_wb,</span>
             <span class="c1">#skeptric_cc,</span>
          <span class="p">],</span>
    <span class="nb">filter</span><span class="o">=</span><span class="n">skeptric_filter</span><span class="p">,</span>
    <span class="n">steps</span> <span class="o">=</span> <span class="p">[</span><span class="n">skeptric_extract</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>And we can run it all with <code>.run</code></p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%time</span>
<span class="n">data</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">skeptric_process</span><span class="o">.</span><span class="n">run</span><span class="p">())</span>
<span class="n">data</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>CPU times: user 248 ms, sys: 11.1 ms, total: 259 ms
Wall time: 285 ms
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[{&#39;title&#39;: &#39;Pagination in Internet Archive&amp;#39;s Wayback Machine with CDX&#39;,
  &#39;url&#39;: &#39;https://skeptric.com/pagination-wayback-cdx/&#39;,
  &#39;timestamp&#39;: datetime.datetime(2021, 11, 26, 11, 28, 34)},
 {&#39;title&#39;: &#39;About Skeptric&#39;,
  &#39;url&#39;: &#39;https://skeptric.com/about/&#39;,
  &#39;timestamp&#39;: datetime.datetime(2021, 11, 26, 11, 28, 37)},
 {&#39;title&#39;: &#39;Searching 100 Billion Webpages Pages With Capture Index&#39;,
  &#39;url&#39;: &#39;https://skeptric.com/searching-100b-pages-cdx/&#39;,
  &#39;timestamp&#39;: datetime.datetime(2021, 11, 26, 11, 28, 39)},
 {&#39;title&#39;: &#39;Fast Web Dataset Extraction Worfklow&#39;,
  &#39;url&#39;: &#39;https://skeptric.com/fast-web-data-workflow/&#39;,
  &#39;timestamp&#39;: datetime.datetime(2021, 11, 26, 11, 28, 39)},
 {&#39;title&#39;: &#39;Unique Key for Web Captures&#39;,
  &#39;url&#39;: &#39;https://skeptric.com/key-web-captures/&#39;,
  &#39;timestamp&#39;: datetime.datetime(2021, 11, 26, 11, 28, 40)},
 {&#39;title&#39;: &#39;Hugo Readdir Error with Emacs&#39;,
  &#39;url&#39;: &#39;https://skeptric.com/emacs-tempfile-hugo/&#39;,
  &#39;timestamp&#39;: datetime.datetime(2021, 11, 26, 11, 28, 40)}]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Note that in the case of errors in the steps the process keeps going, and logs the errors</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">skeptric_error_process</span> <span class="o">=</span> <span class="n">ProcessMemory</span><span class="p">(</span>
    <span class="n">queries</span><span class="o">=</span><span class="p">[</span><span class="n">skeptric_file_query</span><span class="p">,</span>
             <span class="c1"># commented out to make faster</span>
             <span class="c1">#skeptric_wb,</span>
             <span class="c1">#skeptric_cc,</span>
          <span class="p">],</span>
    <span class="nb">filter</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">,</span>
    <span class="n">steps</span> <span class="o">=</span> <span class="p">[</span><span class="n">skeptric_extract</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">skeptric_error_process</span><span class="o">.</span><span class="n">run</span><span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>ERROR:root:Error processing WarcFileRecord(url=&#39;https://skeptric.com/robots.txt&#39;, timestamp=datetime.datetime(2021, 11, 26, 11, 28, 34), mime=&#39;text/html&#39;, status=404, path=PosixPath(&#39;../resources/test/skeptric.warc.gz&#39;), offset=5804, digest=&#39;QRNGXIUXE4LAI3XR5RVATIUX5GTB33HX&#39;) at step skeptric_extract: 
ERROR:root:Error processing WarcFileRecord(url=&#39;https://skeptric.com/style.main.min.5ea2f07be7e07e221a7112a3095b89d049b96c48b831f16f1015bf2d95d914e5.css&#39;, timestamp=datetime.datetime(2021, 11, 26, 11, 28, 35), mime=&#39;text/css&#39;, status=200, path=PosixPath(&#39;../resources/test/skeptric.warc.gz&#39;), offset=7197, digest=&#39;LINCDTSPQGAQGZZ6LY2XFXZHG2X476H6&#39;) at step skeptric_extract: 
ERROR:root:Error processing WarcFileRecord(url=&#39;https://skeptric.com/&#39;, timestamp=datetime.datetime(2021, 11, 26, 11, 28, 36), mime=&#39;text/html&#39;, status=200, path=PosixPath(&#39;../resources/test/skeptric.warc.gz&#39;), offset=17122, digest=&#39;JJVB3MQERHRZJCHOJNKS5VDOODXPZAV2&#39;) at step skeptric_extract: 
ERROR:root:Error processing WarcFileRecord(url=&#39;https://skeptric.com/tags/data&#39;, timestamp=datetime.datetime(2021, 11, 26, 11, 28, 37), mime=&#39;text/html&#39;, status=302, path=PosixPath(&#39;../resources/test/skeptric.warc.gz&#39;), offset=129093, digest=&#39;ZZZXDZTTV2KTABRO64ESHVWFPNKB4I5H&#39;) at step skeptric_extract: 
ERROR:root:Error processing WarcFileRecord(url=&#39;https://skeptric.com/tags/data/&#39;, timestamp=datetime.datetime(2021, 11, 26, 11, 28, 38), mime=&#39;text/html&#39;, status=200, path=PosixPath(&#39;../resources/test/skeptric.warc.gz&#39;), offset=130269, digest=&#39;R7CLAACFU5L7T5LKI5G53RZSMCNUNV6F&#39;) at step skeptric_extract: 
ERROR:root:Error processing WarcFileRecord(url=&#39;https://skeptric.com/images/wayback_empty_returns.png&#39;, timestamp=datetime.datetime(2021, 11, 26, 11, 28, 38), mime=&#39;image/png&#39;, status=200, path=PosixPath(&#39;../resources/test/skeptric.warc.gz&#39;), offset=160971, digest=&#39;SU7JRTHNW6KFCJQFL5PMMKV33U2VLV7T&#39;) at step skeptric_extract: &#39;utf-8&#39; codec can&#39;t decode byte 0x89 in position 0: invalid start byte
ERROR:root:Error processing WarcFileRecord(url=&#39;https://skeptric.com/searching-100b-pages-cdx&#39;, timestamp=datetime.datetime(2021, 11, 26, 11, 28, 39), mime=&#39;text/html&#39;, status=302, path=PosixPath(&#39;../resources/test/skeptric.warc.gz&#39;), offset=173368, digest=&#39;AYVHQLVFIVGZGUYPEHX46CHMZ5NUDDBF&#39;) at step skeptric_extract: 
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We could then investigate them to see what happened</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">datetime</span>
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">PosixPath</span>
<span class="kn">from</span> <span class="nn">webrefine.query</span> <span class="kn">import</span> <span class="n">WarcFileRecord</span>

<span class="n">record</span> <span class="o">=</span> <span class="n">WarcFileRecord</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="s1">&#39;https://skeptric.com/tags/data/&#39;</span><span class="p">,</span> <span class="n">timestamp</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2021</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">26</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">38</span><span class="p">),</span> <span class="n">mime</span><span class="o">=</span><span class="s1">&#39;text/html&#39;</span><span class="p">,</span> <span class="n">status</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="n">PosixPath</span><span class="p">(</span><span class="s1">&#39;../resources/test/skeptric.warc.gz&#39;</span><span class="p">),</span> <span class="n">offset</span><span class="o">=</span><span class="mi">130269</span><span class="p">,</span> <span class="n">digest</span><span class="o">=</span><span class="s1">&#39;R7CLAACFU5L7T5LKI5G53RZSMCNUNV6F&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

</div>
 

