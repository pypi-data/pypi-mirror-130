import{e as O,f as Q,s as n,j as W,D as de,o as r,q as T,N as _e,ai as pe,E as fe,r as x,c as m,d as s,a as u,w as i,A as me,ac as he,u as e,t as l,K as ve,F as X,p as ye,b as we,n as E,m as xe,k as p,g as v}from"./vendor.fa0ef14c.js";import{A as f,E as h,_ as be,f as Y,s as Z}from"./index.87e553a1.js";import{T as ke}from"./Timeline.2dda65d6.js";import{R as ge,M as Re}from"./MiniRadar.c7887c32.js";const Ie=O({props:{id:{type:String,required:!0}},setup(y){const b=y,k=Q(new ge),R=n(()=>({id:b.id})),d={radar:f.query({endpoint:h.radar,body:R,options:{pollInterval:5e3}})};return W(()=>{var a;return(a=d.radar.response)==null?void 0:a.value},a=>{a&&k.value.items(a)}),de(()=>{k.value.id("id").dependencies("upstream_dependencies").items([])}),(a,L)=>(r(),T(Re,{id:y.id,radar:k.value,"hide-viewport":"","disable-interactions":""},null,8,["id","radar"]))}});const g=y=>(ye("data-v-5e3abcd4"),y=y(),we(),y),Te={class:"main-grid"},Fe={class:"d-flex align-center justify-space-between py-1 px-2"},qe={class:"d-inline-flex flex-column"},Ce={class:"flex-grow-0 flex-shrink-1"},Se={class:"d-inline-flex align-center text-truncate"},je={class:"caption font--primary font-weight-semibold text--grey-40 d-flex text-truncate"},Ne={key:0},Be=p(" Started: "),De={class:"text--grey-80 mr-1 ml--half"},Ee={key:1},Le=p(" Ended: "),Ve={class:"text--grey-80 mr-1 ml--half"},Ae={class:"caption font--primary font-weight-semibold text--grey-40 mt-1 d-flex text-truncate"},Me={key:0},$e=p(" Deployment: "),Pe={class:"text--grey-80 mr-1 ml--half"},Ue={key:1},ze=p(" Parent: "),Ge={class:"text--grey-80"},He=p(" /"),Ke={key:2},Je=p(" Results: "),Oe={class:"text--grey-80 mr-1 ml--half"},Qe={key:3},We=p(" Flow version: "),Xe={class:"text--grey-80 mr-1 ml--half"},Ye={class:"font--secondary"},Ze={class:"d-flex align-center justify-space-between py-1 px-2"},et=g(()=>s("div",{class:"subheader"},"Timeline",-1)),tt={class:"timeline-content pb-2 px-2 d-flex flex-grow-1"},st={class:"d-flex align-center justify-space-between py-1 px-2"},nt=g(()=>s("div",{class:"subheader"},"Radar",-1)),ot={class:"radar-content pb-2 px-2 d-flex flex-grow-1"},at=g(()=>s("i",{class:"pi pi-task mr-1 text--grey-40"},null,-1)),rt=p(" Task Runs "),lt=g(()=>s("i",{class:"pi pi-flow-run mr-1 text--grey-40"},null,-1)),ut=p(" Subflow Runs "),it={class:"font--secondary caption my-2",style:{"min-height":"17px"}},ct={class:"results-section d-flex flex-column align-stretch justify-stretch"},dt={class:"text-center my-8",key:"no-results"},_t=g(()=>s("h2",null," No Results Found ",-1)),pt=[_t],ft=g(()=>s("hr",{class:"results-hr mt-3"},null,-1)),mt=O({async setup(y){let b,k;const R=_e(),d=Q("task_runs"),a=n(()=>R==null?void 0:R.params.id),L=n(()=>({id:a.value})),w=([b,k]=pe(()=>f.query({endpoint:h.flow_run,body:L,options:{pollInterval:5e3}}).fetch()),b=await b,k(),b),ee=n(()=>w.response.value.flow_id),I=n(()=>w.response.value.parent_task_run_id),S=n(()=>w.response.value.deployment_id),te=n(()=>({id:ee.value})),se=n(()=>({id:S.value})),V=n(()=>({task_runs:{id:{any_:[I.value]}}})),j=n(()=>({flow_runs:{id:{any_:[a.value]}}})),A=n(()=>({flow_runs:{id:{any_:[a.value]}},task_runs:{subflow_runs:{exists_:!0}}})),o={flow:f.query({endpoint:h.flow,body:te}),deployment:f.query({endpoint:h.deployment,body:se,options:{paused:!S.value}}),parent_flow:f.query({endpoint:h.flows,body:V,options:{paused:!I.value}}),parent_flow_run:f.query({endpoint:h.flow_runs,body:V,options:{paused:!I.value}}),task_runs_count:f.query({endpoint:h.task_runs_count,body:j,options:{pollInterval:1e4}}),task_runs:f.query({endpoint:h.task_runs,body:j,options:{pollInterval:1e4}}),sub_flow_runs_count:f.query({endpoint:h.task_runs_count,body:A,options:{pollInterval:1e4}})},ne={task_runs:"task_runs_count",sub_flow_runs:"sub_flow_runs_count"},F=n(()=>{var t;return d.value&&((t=o[ne[d.value]])==null?void 0:t.response)||0}),N=n(()=>{var t;return((t=o.deployment.response)==null?void 0:t.value)||{}}),M=n(()=>{var t,_;return((_=(t=o.parent_flow.response)==null?void 0:t.value)==null?void 0:_[0])||{}}),$=n(()=>{var t,_;return((_=(t=o.parent_flow_run.response)==null?void 0:t.value)==null?void 0:_[0])||{}}),P=n(()=>{var t,_;return(_=(t=N.value)==null?void 0:t.flow_data)==null?void 0:_.blob}),c=n(()=>{var t;return((t=w.response)==null?void 0:t.value)||{}}),oe=n(()=>c.value.end_time),q=n(()=>{var t;return(t=c.value)==null?void 0:t.state}),ae=n(()=>{var t;return((t=c.value)==null?void 0:t.tags)||[]}),re=n(()=>{var t;return((t=o.task_runs_count.response)==null?void 0:t.value)||0}),le=n(()=>{var t;return((t=o.sub_flow_runs_count.response)==null?void 0:t.value)||0}),U=n(()=>{var t;return((t=o.task_runs.response)==null?void 0:t.value)||[]}),ue=n(()=>q.value.type=="PENDING"||q.value.type=="SCHEDULED"?"--":c.value.total_run_time?Z(c.value.total_run_time):Z(c.value.estimated_run_time));return fe(()=>{w.stopPolling(),f.queries.delete(w.id)}),W(a,async()=>{await w.fetch(),o.flow.fetch(),o.task_runs_count.fetch(),o.task_runs.fetch(),o.sub_flow_runs_count.fetch(),S.value?o.deployment.fetch():o.deployment.clearResult(),I.value?o.parent_flow.fetch():o.parent_flow.clearResult(),I.value?o.parent_flow_run.fetch():o.parent_flow_run.clearResult(),d.value="task_runs"}),(t,_)=>{var K;const ie=x("Tag"),B=x("router-link"),D=x("Card"),z=x("IconButton"),G=x("Tab"),ce=x("Tabs"),H=x("ResultsList");return r(),m(X,null,[s("div",Te,[u(D,{class:"details",shadow:"sm"},{default:i(()=>{var C;return[s("div",Fe,[s("div",qe,[s("div",Ce,[s("span",{class:E(["run-state correct-text caption mr-1",((C=e(q).type)==null?void 0:C.toLowerCase())+"-bg"])},l(e(q).name),3),s("span",Se,[(r(!0),m(X,null,xe(e(ae),J=>(r(),T(ie,{key:J,color:"secondary-pressed",class:"font--primary caption font-weight-semibold mr-1",icon:"pi-label",flat:""},{default:i(()=>[p(l(J),1)]),_:2},1024))),128)),s("div",je,[e(c).start_time?(r(),m("span",Ne,[Be,s("span",De,l(e(Y)(e(c).start_time)),1)])):v("",!0),e(c).end_time?(r(),m("span",Ee,[Le,s("span",Ve,l(e(Y)(e(c).end_time)),1)])):v("",!0)])])]),s("div",Ae,[e(N).name?(r(),m("span",Me,[$e,s("span",Pe,l(e(N).name),1)])):v("",!0),e(M).name?(r(),m("span",Ue,[ze,s("span",Ge,l(e(M).name),1),He,u(B,{to:`/flow-run/${e($).id}`,class:"mr-1 ml--half text--primary"},{default:i(()=>[p(l(e($).name),1)]),_:1},8,["to"])])):v("",!0),e(P)?(r(),m("span",Ke,[Je,s("span",Oe,l(e(P)),1)])):v("",!0),e(c).flow_version?(r(),m("span",Qe,[We,s("span",Xe,l(e(c).flow_version),1)])):v("",!0)])]),s("div",Ye,l(e(ue)),1)])]}),_:1}),u(D,{class:"timeline d-flex flex-column",width:"auto",shadow:"sm"},{header:i(()=>[s("div",Ze,[et,u(B,{to:`/flow-run/${e(a)}/timeline`},{default:i(()=>[u(z,{icon:"pi-full-screen"})]),_:1},8,["to"])])]),default:i(()=>[s("div",tt,[e(U).length?(r(),T(ke,{key:0,items:e(U),"max-end-time":e(oe),"hide-header":"","axis-position":"bottom","background-color":"blue-5"},null,8,["items","max-end-time"])):v("",!0)])]),_:1}),u(D,{class:"radar",shadow:"sm"},{header:i(()=>[s("div",st,[nt,u(B,{to:`/flow-run/${e(a)}/radar`},{default:i(()=>[u(z,{icon:"pi-full-screen"})]),_:1},8,["to"])])]),default:i(()=>[s("div",ot,[u(Ie,{id:e(a)},null,8,["id"])])]),_:1})]),u(ce,{modelValue:d.value,"onUpdate:modelValue":_[0]||(_[0]=C=>d.value=C),class:"mt-3"},{default:i(()=>[u(G,{href:"task_runs",class:"subheader"},{default:i(()=>[at,rt,s("span",{class:E(["result-badge caption ml-1",{active:d.value=="task_runs"}])},l(e(re).toLocaleString()),3)]),_:1}),u(G,{href:"sub_flow_runs",class:"subheader"},{default:i(()=>[lt,ut,s("span",{class:E(["result-badge caption ml-1",{active:d.value=="sub_flow_runs"}])},l(e(le).toLocaleString()),3)]),_:1})]),_:1},8,["modelValue"]),s("div",it,[me(s("span",null,l((K=e(F).value)==null?void 0:K.toLocaleString())+" Result"+l(e(F).value!==1?"s":""),513),[[he,e(F).value>0]])]),s("section",ct,[u(ve,{name:"tab-fade",mode:"out-in",css:""},{default:i(()=>[e(F)===0?(r(),m("div",dt,pt)):d.value=="task_runs"?(r(),T(H,{key:"task_runs",filter:e(j),component:"list-item-task-run",endpoint:"task_runs","poll-interval":5e3},null,8,["filter"])):d.value=="sub_flow_runs"?(r(),T(H,{key:"sub_flow_runs",filter:e(A),component:"list-item-sub-flow-run",endpoint:"task_runs","poll-interval":5e3},null,8,["filter"])):v("",!0)]),_:1})]),ft],64)}}});var xt=be(mt,[["__scopeId","data-v-5e3abcd4"]]);export{xt as default};
